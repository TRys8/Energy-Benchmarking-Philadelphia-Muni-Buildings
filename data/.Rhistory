test$y_eq_123 <- apply(test[, c("y_x1","y_x2","y_x3")], 1, mean)
test$y_w123 <- apply(test[, c("y_x1","y_x2","y_x3")], 1, weighted.mean, w=c(.4, .3, .2))
cor(test[, c("y_eq_123", "y_x123")])
mu <- c(0, 0, 0, 0)
sigma <- matrix(c(1, .7, .5, .2,
.7, 1, .2, .2,
.5, .2, 1, .2,
.2, .2, .2, 1), ncol=4, nrow=4)
# set.seed(1)
data <- data.frame(mvrnorm(10000, mu=mu, Sigma=sigma))
names(data) <- c("y", "x1", "x2", "x3")
train <- data[1:8000,]
test <- data[8001:10000,]
lm.1 <- lm(y ~ x1, data=train)
lm.2 <- lm(y ~ x2, data=train)
lm.3 <- lm(y ~ x3, data=train)
lm.123 <- lm(y ~ x1 + x2 + x3, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x123 <- predict(lm.123, newdata=test)
test$y_eq_123 <- apply(test[, c("y_x1","y_x2","y_x3")], 1, mean)
test$y_w123 <- apply(test[, c("y_x1","y_x2","y_x3")], 1, weighted.mean, w=c(.4, .3, .2))
cor(test[, c("y_eq_123", "y_x123")])
mu <- c(0, 0, 0, 0)
sigma <- matrix(c(1, .7, .5, .2,
.7, 1, .2, .2,
.5, .2, 1, .2,
.2, .2, .2, 1), ncol=4, nrow=4)
# set.seed(1)
data <- data.frame(mvrnorm(10000, mu=mu, Sigma=sigma))
names(data) <- c("y", "x1", "x2", "x3")
train <- data[1:8000,]
test <- data[8001:10000,]
lm.1 <- lm(y ~ x1, data=train)
lm.2 <- lm(y ~ x2, data=train)
lm.3 <- lm(y ~ x3, data=train)
lm.123 <- lm(y ~ x1 + x2 + x3, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x123 <- predict(lm.123, newdata=test)
test$y_eq_123 <- apply(test[, c("y_x1","y_x2","y_x3")], 1, mean)
test$y_w123 <- apply(test[, c("y_x1","y_x2","y_x3")], 1, weighted.mean, w=c(.4, .3, .2))
cor(test[, c("y_eq_123", "y_x123")])
library(mlbench)
install.packages("mlbench")
data(BostonHousing2)
library(mlbench)
data(BostonHousing2)
summary(data)
summary(BostonHousing2)
data(iris)
summaray(iris)
summary(iris)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
summary(lm.1)
summary(lm.2)
summary(lm.3)
summary(lm.4)
summary(lm.1234)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
cor(test[, c("y_eq_1234", "y_x1234")])
RMSE
source("~/Dropbox/mungekit.R")
RMSE
RMSE()
?RMSE
?MSE
myRMSE()
myRMSE
myRMSE(a=test$cmedv, p=test$y_x1234)
myRMSE(a=test$cmedv, p=test$y_eq_1234)
myRMSE(a=test$cmedv, p=test$y_x1234)
myRMSE(a=test$cmedv, p=test$y_eq_1234)
myRMSE(a=test$cmedv, p=test$y_x1234)/myRMSE(a=test$cmedv, p=test$y_eq_1234)
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
data(BostonHousing2)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
train_index <- sample(1:506, size=350, replace=F)
train <- BostonHousing2[train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
test <- BostonHousing2[-train_index, c("cmedv", "age", "crim", "ptratio", "tax")]
lm.1 <- lm(cmedv ~ age, data=train)
lm.2 <- lm(cmedv ~ crim, data=train)
lm.3 <- lm(cmedv ~ ptratio, data=train)
lm.4 <- lm(cmedv ~ tax, data=train)
lm.1234 <- lm(cmedv ~ age + crim + ptratio + tax, data=train)
test$y_x1 <- predict(lm.1, newdata=test)
test$y_x2 <- predict(lm.2, newdata=test)
test$y_x3 <- predict(lm.3, newdata=test)
test$y_x4 <- predict(lm.4, newdata=test)
test$y_eq_1234<- apply(test[, c("y_x1","y_x2","y_x3", "y_x4")], 1, mean)
test$y_x1234 <- predict(lm.1234, newdata=test)
# cor(test[, c("y_eq_1234", "y_x1234")])
myRMSE(a=test$cmedv, p=test$y_eq_1234)/myRMSE(a=test$cmedv, p=test$y_x1234)
library(stringr)
library(tidyr)
library(dplyr)
setwd("~/Dropbox/Energy-Benchmarking-Philadelphia-Muni-Buildings/data")
energy_df <- read.csv("../data/2011-13 Philadelphia Municipal Building Energy Usage.csv", stringsAsFactors=F)
energy_df <- rename(energy_df, weui = Weather.Normalized.Source.EUI..kBtu.ft2.)
weui_df <- energy_df[, c("Property.Id", "weui", "Year")]
weui_df_wide <- weui_df %>% spread(Year, weui)
names(weui_df_wide) <- c("Property.Id", paste0("weui", 2011:2013))
weui_df_wide$perc_1213 <- ((weui_df_wide$weui2013 - weui_df_wide$weui2012) / weui_df_wide$weui2012) * 100
weui_df_wide$raw_1213 <- weui_df_wide$weui2013 - weui_df_wide$weui2012
weui_df_wide$avg_1113 <- apply(weui_df_wide[, c("weui2011", "weui2012", "weui2013")], FUN=mean, na.rm=T)
weui_df_wide$avg_1113 <- apply(weui_df_wide[, c("weui2011", "weui2012", "weui2013")], 1, FUN=mean, na.rm=T)
head(weui_df_wide)
loc_df <- energy_df[, c("Property.Id", "Property.Name", "Address.1", "Location")]
loc_df <- loc_df[!duplicated(loc_df$Property.Id),]
loc_df$coords <- str_sub(loc_df$Location, start=sapply(loc_df$Location, FUN=function(x){str_locate(x, pattern=fixed("("))[1]}))
loc_df$lat <- str_sub(loc_df$coords,
start=sapply(loc_df$coords, FUN=function(x){str_locate(x, pattern=fixed("("))[1] + 1}),
end=sapply(loc_df$coords, FUN=function(x){str_locate(x, pattern=fixed(","))[1]} - 1)
)
loc_df$lon <- str_sub(loc_df$coords,
start=sapply(loc_df$coords, FUN=function(x){str_locate(x, pattern=fixed(","))[1] + 2}),
end=sapply(loc_df$coords, FUN=function(x){str_locate(x, pattern=fixed(")"))[1]} - 1)
)
loc_df$Location <- NULL
loc_df$coords <- NULL
muni_energy_df <- merge(loc_df, weui_df_wide, by="Property.Id")
names(muni_energy_df) <- c("property_id", "property_name", "address", "lat", "lon", "weui2011", "weui2012", "weui2013", "perc_1213", "raw_1213", "avg_1113")
write.table(muni_energy_df, "muni_energy.csv", sep=",", row.names=F)
summary(muni_energy_df)
